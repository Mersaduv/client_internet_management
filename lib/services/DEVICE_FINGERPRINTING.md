# ุณุณุชู Device Fingerprinting - ุดูุงุณุง ุฏุณุชฺฏุงู ุญุช ุจุง ุชุบุฑ IP/MAC

## ๐ ููุฏูู

ุงู ุณุณุชู ุจุฑุง ุญู ูุดฺฉู ุดูุงุณุง ุฏุณุชฺฏุงูโูุง ูุณุฏูุฏ ุดุฏู ุทุฑุงุญ ุดุฏู ุงุณุช. ูุดฺฉู ุงุตู ุงู ุจูุฏ ฺฉู ููุช ฺฉ ุฏุณุชฺฏุงู (ูุซูุงู iPhone) ูุณุฏูุฏ ูโุดุฏุ ุจุนุฏ ุงุฒ ฺูุฏ ุฑูุฒ ุจุง IP ุง MAC address ุฌุฏุฏ ูุชุตู ูโุดุฏ ู ุณุณุชู ููโุชูุงูุณุช ุขู ุฑุง ุดูุงุณุง ฺฉูุฏ.

## ๐ ฺฺฏููู ฺฉุงุฑ ูโฺฉูุฏุ

### Device Fingerprint ฺุณุชุ

Device Fingerprint ฺฉ ุดูุงุณู ููุญุตุฑ ุจู ูุฑุฏ ุงุณุช ฺฉู ุงุฒ ุชุฑฺฉุจ ฺูุฏ ูฺฺฏ ุฏุณุชฺฏุงู ุณุงุฎุชู ูโุดูุฏ:

1. **Hostname** (ูููโุชุฑู) - ูุนูููุงู ุชุบุฑ ููโฺฉูุฏ
   - ูุซุงู: "iPhone-12-Pro", "Samsung-Galaxy-S21"
   
2. **MAC Vendor** (3 ุจุงุช ุงูู MAC) - ูุดุงูโุฏููุฏู ุณุงุฒูุฏู ุฏุณุชฺฏุงู
   - ูุซุงู: "00:1B:44" ุจุฑุง Apple
   
3. **Device Type** - ุงุฒ hostname ุงุณุชุฎุฑุงุฌ ูโุดูุฏ
   - ูุซุงู: "iPhone", "Samsung", "Xiaomi"
   
4. **SSID** - ุจุฑุง ุฏุณุชฺฏุงูโูุง wireless
   - ูุงู ุดุจฺฉู ูุงโูุง ฺฉู ุฏุณุชฺฏุงู ุจู ุขู ูุชุตู ุงุณุช

### ูุซุงู ุนูู

ูุฑุถ ฺฉูุฏ ฺฉ iPhone ุจุง ูุดุฎุตุงุช ุฒุฑ ูุณุฏูุฏ ูโฺฉูุฏ:
- IP: `192.168.1.100`
- MAC: `00:1B:44:AA:BB:CC`
- Hostname: `iPhone-12-Pro`
- SSID: `MyWiFi`

Device Fingerprint ุงู ุฏุณุชฺฏุงู:
```
fingerprintId = "iphone-12-pro|iphone|00:1B:44|mywifi"
```

ุญุงูุง ุงฺฏุฑ ุงู iPhone ุจุนุฏ ุงุฒ ฺูุฏ ุฑูุฒ ุจุง ูุดุฎุตุงุช ุฌุฏุฏ ูุชุตู ุดูุฏ:
- IP: `192.168.1.200` (ุชุบุฑ ฺฉุฑุฏู)
- MAC: `00:1B:44:DD:EE:FF` (ุชุบุฑ ฺฉุฑุฏู - Private MAC Address)
- Hostname: `iPhone-12-Pro` (ููุงู ุงุณุช!)
- SSID: `MyWiFi` (ููุงู ุงุณุช!)

ุณุณุชู ุจุง ููุงุณู Device Fingerprint ูโุชูุงูุฏ ุชุดุฎุต ุฏูุฏ ฺฉู ุงู ููุงู ุฏุณุชฺฏุงู ูุจู ุงุณุช ู ุจู ุตูุฑุช ุฎูุฏฺฉุงุฑ ุขู ุฑุง ูุณุฏูุฏ ูโฺฉูุฏ.

## ๐๏ธ ูพุงุฏูโุณุงุฒ

### 1. ูุฏู DeviceFingerprint

ูุงู: `lib/models/device_fingerprint.dart`

ุงู ูุฏู Device Fingerprint ุฑุง ุชุนุฑู ูโฺฉูุฏ ู ุดุงูู:
- ูุญุงุณุจู `fingerprintId` ุงุฒ ุชุฑฺฉุจ ูฺฺฏโูุง
- ุชุงุจุน `matches()` ุจุฑุง ููุงุณู ุฏู Device Fingerprint
- ุชุจุฏู ุจู/ุงุฒ Map ุจุฑุง ุฐุฎุฑูโุณุงุฒ

### 2. ุณุฑูุณ DeviceFingerprintService

ูุงู: `lib/services/device_fingerprint_service.dart`

ุงู ุณุฑูุณ:
- Device Fingerprints ูุณุฏูุฏ ุดุฏู ุฑุง ุฏุฑ SharedPreferences ุฐุฎุฑู ูโฺฉูุฏ
- ููฺฏุงู ุจุฑุฑุณ ุฏุณุชฺฏุงูโูุง ูุชุตูุ ุขูโูุง ุฑุง ุจุง ูุณุช ูุณุฏูุฏ ุดุฏูโูุง ููุงุณู ูโฺฉูุฏ
- ุชูุงุจุน ุจุฑุง ุฐุฎุฑูุ ุญุฐู ู ุฌุณุชุฌู Device Fingerprints

### 3. ุจูโุฑูุฒุฑุณุงู MikroTikService

ูุงู: `lib/services/mikrotik_service.dart`

ุชูุงุจุน ุฌุฏุฏ:
- `banClientWithFingerprint()` - ูุณุฏูุฏ ฺฉุฑุฏู ุจุง Device Fingerprint
- `unbanClientWithFingerprint()` - ุฑูุน ูุณุฏูุฏุช ุจุง Device Fingerprint
- `checkAndBanBannedDevices()` - ุจุฑุฑุณ ู ูุณุฏูุฏ ฺฉุฑุฏู ุฎูุฏฺฉุงุฑ ุฏุณุชฺฏุงูโูุง ูุชุตู

### 4. ุจูโุฑูุฒุฑุณุงู ClientsProvider

ูุงู: `lib/providers/clients_provider.dart`

ุชูุงุจุน `banClient()` ู `unbanClient()` ุจูโุฑูุฒุฑุณุงู ุดุฏูุฏ ุชุง:
- Hostname ู SSID ุฑุง ุฏุฑุงูุช ฺฉููุฏ
- ุงุฒ Device Fingerprint ุงุณุชูุงุฏู ฺฉููุฏ
- ุจู ุตูุฑุช ุฎูุฏฺฉุงุฑ ุฏุณุชฺฏุงูโูุง ุฏฺฏุฑ ุจุง ููุงู Fingerprint ุฑุง ุจุฑุฑุณ ฺฉููุฏ

## ๐ ุงูฺฏูุฑุชู ุดูุงุณุง

### ุงูููุช 1: Hostname
ุงฺฏุฑ hostname ฺฉุณุงู ุจุงุดุฏุ ูุทุนุงู ููุงู ุฏุณุชฺฏุงู ุงุณุช.

```dart
if (hostname1.toLowerCase() == hostname2.toLowerCase()) {
  return true; // ููุงู ุฏุณุชฺฏุงู
}
```

### ุงูููุช 2: MAC Vendor + Device Type + SSID
ุงฺฏุฑ hostname ูุฏุงุฑูุ ุงุฒ ุชุฑฺฉุจ ุงู ุณู ุงุณุชูุงุฏู ูโฺฉูู:

```dart
if (macVendor1 == macVendor2 && 
    deviceType1 == deviceType2 && 
    ssid1 == ssid2) {
  return true; // ุงุญุชูุงูุงู ููุงู ุฏุณุชฺฏุงู
}
```

### ุงูููุช 3: MAC Vendor + Device Type
ุญุช ุจุฏูู SSIDุ ุงฺฏุฑ MAC Vendor ู Device Type ฺฉุณุงู ุจุงุดูุฏ:

```dart
if (macVendor1 == macVendor2 && 
    deviceType1 == deviceType2) {
  return true; // ุงุญุชูุงูุงู ููุงู ุฏุณุชฺฏุงู
}
```

## ๐ ุฌุฑุงู ฺฉุงุฑ

### ููฺฏุงู ูุณุฏูุฏ ฺฉุฑุฏู:

1. ฺฉุงุฑุจุฑ ุฑู ุฏฺฉูู "ูุณุฏูุฏ ฺฉุฑุฏู" ฺฉูฺฉ ูโฺฉูุฏ
2. ุณุณุชู Device Fingerprint ุฑุง ุงุฒ ClientInfo ูุญุงุณุจู ูโฺฉูุฏ
3. Device Fingerprint ุฏุฑ SharedPreferences ุฐุฎุฑู ูโุดูุฏ
4. Raw rules ุฏุฑ MikroTik ุงุฌุงุฏ ูโุดููุฏ (ุจุง comment ุดุงูู fingerprintId)
5. DHCP Block ู Wireless Access List ุชูุธู ูโุดููุฏ

### ููฺฏุงู ุงุชุตุงู ุฏุณุชฺฏุงู ุฌุฏุฏ:

1. ุณุณุชู ูุณุช ุฏุณุชฺฏุงูโูุง ูุชุตู ุฑุง ุฏุฑุงูุช ูโฺฉูุฏ
2. ุจุฑุง ูุฑ ุฏุณุชฺฏุงูุ Device Fingerprint ูุญุงุณุจู ูโุดูุฏ
3. ุจุง ูุณุช Device Fingerprints ูุณุฏูุฏ ุดุฏู ููุงุณู ูโุดูุฏ
4. ุงฺฏุฑ ูุทุงุจูุช ูพุฏุง ฺฉุฑุฏุ ุจู ุตูุฑุช ุฎูุฏฺฉุงุฑ ูุณุฏูุฏ ูโุดูุฏ

### ููฺฏุงู ุฑูุน ูุณุฏูุฏุช:

1. ฺฉุงุฑุจุฑ ุฑู ุฏฺฉูู "ุฑูุน ูุณุฏูุฏุช" ฺฉูฺฉ ูโฺฉูุฏ
2. ุณุณุชู Device Fingerprint ุฑุง ูุญุงุณุจู ูโฺฉูุฏ
3. Device Fingerprint ุงุฒ SharedPreferences ุญุฐู ูโุดูุฏ
4. Raw rules ุงุฒ MikroTik ุญุฐู ูโุดููุฏ
5. DHCP Block ู Wireless Access List ุฑูุน ูโุดููุฏ

## โ๏ธ ูุญุฏูุฏุชโูุง

1. **Hostname ุชุบุฑ ฺฉูุฏ**: ุงฺฏุฑ ฺฉุงุฑุจุฑ hostname ุฏุณุชฺฏุงู ุฑุง ุชุบุฑ ุฏูุฏุ ุณุณุชู ููโุชูุงูุฏ ุขู ุฑุง ุดูุงุณุง ฺฉูุฏ
   - ุฑุงู ุญู: ุงุณุชูุงุฏู ุงุฒ MAC Vendor + Device Type + SSID

2. **Private MAC Address**: iOS ู Android ุงุฒ Private MAC Address ุงุณุชูุงุฏู ูโฺฉููุฏ
   - ุฑุงู ุญู: ุงุณุชูุงุฏู ุงุฒ Hostname ฺฉู ูุนูููุงู ุชุบุฑ ููโฺฉูุฏ

3. **ุฏุณุชฺฏุงูโูุง ุจุฏูู Hostname**: ุงฺฏุฑ ุฏุณุชฺฏุงู hostname ูุฏุงุดุชู ุจุงุดุฏ
   - ุฑุงู ุญู: ุงุณุชูุงุฏู ุงุฒ MAC Vendor + Device Type

## โ ูุฒุงุง

1. **ุดูุงุณุง ุญุช ุจุง ุชุบุฑ IP/MAC**: ุฏุณุชฺฏุงูโูุง ุญุช ุจุง IP/MAC ุฌุฏุฏ ุดูุงุณุง ูโุดููุฏ
2. **ูุณุฏูุฏุณุงุฒ ุฎูุฏฺฉุงุฑ**: ุฏุณุชฺฏุงูโูุง ูุณุฏูุฏ ุดุฏู ุจู ุตูุฑุช ุฎูุฏฺฉุงุฑ ุฏูุจุงุฑู ูุณุฏูุฏ ูโุดููุฏ
3. **ุฐุฎุฑูโุณุงุฒ ูุญู**: Device Fingerprints ุฏุฑ SharedPreferences ุฐุฎุฑู ูโุดููุฏ (ุจุฏูู ูุงุฒ ุจู ุณุฑูุฑ)
4. **ฺฉุงุฑุง ุจุงูุง**: ุงุณุชูุงุฏู ุงุฒ Raw rules ุฏุฑ MikroTik ุจุฑุง ฺฉุงุฑุง ุจูุชุฑ

## ๐ ูุซุงู ุงุณุชูุงุฏู

```dart
// ูุณุฏูุฏ ฺฉุฑุฏู ุจุง Device Fingerprint
await provider.banClient(
  '192.168.1.100',
  macAddress: '00:1B:44:AA:BB:CC',
  hostname: 'iPhone-12-Pro',
  ssid: 'MyWiFi',
);

// ุจุฑุฑุณ ู ูุณุฏูุฏ ฺฉุฑุฏู ุฎูุฏฺฉุงุฑ
final newlyBanned = await service.checkAndBanBannedDevices();
```

## ๐ง ุชูุธูุงุช

Device Fingerprints ุฏุฑ SharedPreferences ุจุง ฺฉูุฏ `banned_device_fingerprints` ุฐุฎุฑู ูโุดููุฏ.

ุจุฑุง ูพุงฺฉ ฺฉุฑุฏู ููู Device Fingerprints:
```dart
final service = DeviceFingerprintService();
await service.clearAllBannedFingerprints();
```
